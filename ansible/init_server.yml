# Initial server setup (see: https://www.digitalocean.com/community/tutorials/initial-server-setup-with-ubuntu-22-04)
- name: Initial server setup
  user: root
  hosts: all
  vars_files:
    - vars/user_vault.yml

  tasks:
  - name: Add the user and append to appropriate groups
    user:
      name: "{{ item.name }}"
      shell: /bin/bash
      groups: "{{ item.groups | default('') }}"
      password: "{{ item.password }}"
      append: yes
    with_items: "{{ create_users | default([]) }}"
    no_log: true

